# the working directory
workdir: /storage/COSMOGRAIL/VST_J0248_for_new_pipeline/
# where to find new images
raw_dirs:
  - /storage/COSMOGRAIL/VST_J0248_for_new_pipeline/raw
# redo flag, used by most processes
redo: 0
# some processes can be parallelized
multiprocessing_cpu_count: 4

# now we define our Region of Interest (ROI)
# the ROI will be extracted, and have flux calibrated cutouts prepared.
ROI:
  J0248+1913: 
    coordinates: [42.2031, 19.22528]  # [ra, dec] in degrees
    cutout_size: 50  # in pixels
# the ROI will be used as a position starting point for the plate solving.

# telescope information:
telescope:
  name: VST
  longitude: -70.4
  latitude: -24.6
  elevation: 2635.0
  imager_name: OmegaCAM

# do plots of extracted sources?
source_extraction_do_plots: 1
# trimming the images upon importation, in pixels
trim_vertical: 1200
trim_horizontal: 200

# are your images already plate solved? if yes, we will skip the plate solving step 
already_plate_solved: 0
# plate solving strategy: plate solve all, or plate solve one and align the others 
# onto the first one.
# possibilities: 'plate_solve_all', 'plate_solve_then_align'
# I recommend the first one, it'll be a bit slower ...but also more robust to
# variations in the pointing.
plate_solving_strategy: 'plate_solve'

# this is a plate scale interval to speed up the plate solving, 
# you can make it more precise if you know the plate scale of your instrument. 
# In arcseconds per pixel.
plate_scale_interval: [0.19, 0.23]

# now for the plate solving, we are going to use my wrapper around Astrometry.net:
# widefield_plate_solver
# It can either use a local installation (solve-field command in path)
# or the astrometry.net api. We will try to use the local installation
# if the astrometry api key below is null.
# else we'll use the API.
astrometry_net_api_key: null

# now the calibration stars selection.
# we can either focus on the footprint common to all images, the idea being stability across
# epochs in both the PSF model and normalization coefficient.
# only works with stable pointings obviously.
# param name: 'common_footprint_stars'
# The other possibility is looking for stars close to the ROI in each frame.
# We aim for stability as much as possible (selecting from the common footprint first,
# then adding more stars). Unavoidable when the pointings are not regular.
# param name: 'common_footprint_with_extra_stars'
# third possibility, we do not care about the footprints and simply select the best 
# stars in each image, with a preference close to the ROI. 
# pram name: 'stars_per_frame'
# in summary: 'common_footprint_stars', 'common_footprint_with_extra_stars', or 'stars_per_frame'.
star_selection_strategy: 'common_footprint_stars'
# now the stars, depending on your setup you will need to probe a different range
# of magnitudes to both provide high S/N constraints to your normalization and PSF models,
# while avoiding saturation -- set to null for no contraints
star_min_gmag: 16.5
star_max_gmag: 19.0
# we discard stars that were not well fitted by a point source solution in gaia
# (could be galaxies, or very crowded fields, or doubles ...which we need to avoid)
# set to null for no constraints
star_max_astrometric_excess_noise: 2.0
# finally, we can also request a small photometric error,
# as the photometric error will go up with variability. this way we can select
# more stable stars.
star_max_phot_g_mean_flux_error: 2.0
# number criterion
min_number_stars: 4
# and whether we query again ... please set it to true should you need to change the footprint type
gaia_query_redo: false
